<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-design/pubsub/pubsub-api-and-compability-with-dapr-component" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Layotto Pub/Sub, Compatible Dapr Package Scheme | Layotto</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mosn.io/en-US/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://mosn.io/en-US/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://mosn.io/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component"><meta data-rh="true" property="og:locale" content="en_US"><meta data-rh="true" property="og:locale:alternate" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="en-US"><meta data-rh="true" name="docsearch:language" content="en-US"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Layotto Pub/Sub, Compatible Dapr Package Scheme | Layotto"><meta data-rh="true" name="description" content="1. Support Pub/Sub API"><meta data-rh="true" property="og:description" content="1. Support Pub/Sub API"><link data-rh="true" rel="icon" href="https://gw.alipayobjects.com/zos/bmw-prod/65518bfc-8ba5-4234-a5c5-2bc065e3a5f0.svg"><link data-rh="true" rel="canonical" href="https://mosn.io/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component"><link data-rh="true" rel="alternate" href="https://mosn.io/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://mosn.io/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://mosn.io/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://B0I4Q5CLN8-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/en-US/blog/rss.xml" title="Layotto RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en-US/blog/atom.xml" title="Layotto Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Layotto" href="/en-US/opensearch.xml"><link rel="stylesheet" href="/en-US/assets/css/styles.a91448ad.css">
<script src="/en-US/assets/js/runtime~main.3f37fcd7.js" defer="defer"></script>
<script src="/en-US/assets/js/main.34dafc41.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en-US/"><div class="navbar__logo"><img src="https://gw.alipayobjects.com/zos/bmw-prod/65518bfc-8ba5-4234-a5c5-2bc065e3a5f0.svg" alt="Layotto Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://gw.alipayobjects.com/zos/bmw-prod/65518bfc-8ba5-4234-a5c5-2bc065e3a5f0.svg" alt="Layotto Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Layotto</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en-US/docs/">Docs</a><a class="navbar__item navbar__link" href="/en-US/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-US">English</a></li><li><a href="/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/mosn/layotto" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en-US/docs/">Home Page</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/en-US/docs/start/">Quick Start</a><button aria-label="展开侧边栏分类 &#x27;Quick Start&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en-US/docs/start/lab">Online Lab</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/en-US/docs/building_blocks/file/">User Manual</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/en-US/docs/configuration/overview">Operations Manual</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/en-US/docs/design/lifecycle/apply_configuration">Design Doc</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/lifecycle/apply_configuration">Dynamically configure the sending, component heated reload</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/actuator/actuator-design-doc">Actuator Design Document</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/actuator/grpc-design-doc">MOSN gRPC framework design document</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/configuration/configuration-api-with-apollo">Implementing Configuration API with ctripcorp/apollo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component">Layotto Pub/Sub, Compatible Dapr Package Scheme</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/rpc/rpc_design_document">RPC Design Document</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/lock/lock-api-design">Add TryLock and Unlock API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/sequencer/design">Sequencer API design document</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/file/file-design">File API design documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/faas/faas-poc-design">FaaS Design Document</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/api_plugin/design">API Plugin Design Documentation &amp; Use Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/api_plugin/dapr_api">dapr_api</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/oss/design">Layotto object storage (OSS) and collection of API interface definitions and design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en-US/docs/design/pluggable/design">Pluggable Component Design Document</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/en-US/docs/development/CONTRIBUTING">Contribute Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/en-US/docs/community/meeting">Community</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en-US/docs/video/">Video collection</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home Page" class="breadcrumbs__link" href="/en-US/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Design Doc</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Layotto Pub/Sub, Compatible Dapr Package Scheme</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Overview</button></div><div class="theme-doc-markdown markdown"><h1>Layotto Pub/Sub, Compatible Dapr Package Scheme</h1>
<h1>Needs analysis</h1>
<ol>
<li>Support Pub/Sub API</li>
<li>Packages that can be reused as much as possible on the architecture</li>
</ol>
<h1>Overview design</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="whether-the-corporate-architecturereuses-daprs-sdk-and-proto">Whether the corporate architecture：reuses Dapr&#x27;s sdk and proto<a class="hash-link" aria-label="Whether the corporate architecture：reuses Dapr&#x27;s sdk and proto的直接链接" title="Whether the corporate architecture：reuses Dapr&#x27;s sdk and proto的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#whether-the-corporate-architecturereuses-daprs-sdk-and-proto">​</a></h2>
<p>In order to be able to develop a set of API specs with the Dapr and Envoy communities in the future, the Dapr API is being kept as close as possible.</p>
<p>Dapr component libraries can be reused directly; below discuss whether sdk and proto are repeated and how to use them again.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problems-encountered">Problems encountered<a class="hash-link" aria-label="Problems encountered的直接链接" title="Problems encountered的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#problems-encountered">​</a></h3>
<ol>
<li>dapr sdk wrote the pack name in which the call interface was called, with dapr
<img decoding="async" loading="lazy" alt="img.png" src="/en-US/assets/images/img-d79078821c14a2ec1619eb5d6e9baa02.png" width="2326" height="428" class="img_ev3q"></li>
<li>We will have differentiated needs, such as new fields, new APIs, if directly using dapr.proto will not be flexible</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="programmes">Programmes<a class="hash-link" aria-label="Programmes的直接链接" title="Programmes的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#programmes">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="no-longer-using-sdk-and-proto-detach-proto-file-neutral-path">No longer using sdk and proto; detach proto file, neutral path<a class="hash-link" aria-label="No longer using sdk and proto; detach proto file, neutral path的直接链接" title="No longer using sdk and proto; detach proto file, neutral path的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#no-longer-using-sdk-and-proto-detach-proto-file-neutral-path">​</a></h4>
<p><img decoding="async" loading="lazy" alt="img_1.png" src="/en-US/assets/images/img_1-3c5a1b8312d5bbfd2e0adcd9d1579b16.png" width="625" height="500" class="img_ev3q"></p>
<p>We first define an api-spec.proto, a superset of dapr API, with a neutral path name without layotto, based on this proto itself develop a neutral RuntimeAPI sdk.</p>
<p>Then try promoting proto into a community-sanctioned api-spec, or working with other communities to rebuild a path neutral api-spec.proto.</p>
<p>If proto changes in the promotion process does not matter anything, Layotto draws a layer of API below proto to prevent proto;</p>
<p>If not, we can write a dapr adapter first in a neutral sdk, using our sdk to both adjust the dapr and layotto：</p>
<p><img decoding="async" loading="lazy" alt="img_2.png" src="/en-US/assets/images/img_2-e1811e5f0c86035a7caedf496f40ac64.png" width="643" height="416" class="img_ev3q"></p>
<p>Advantages：</p>
<ol>
<li>Clean.If you want to revert to Dapr&#x27;s sdk and proto, there is an unavoidable problem：when the API and dapr are different, you need to encapsulate a layer of logic for yourself, which will bring complexity, hacky, hill sense and increase the code reading threshold</li>
<li>Extensions between API and Dapr</li>
</ol>
<p>： Disadvantages</p>
<ol>
<li>Follow Dapr client or proto modified. We may not know, causing inconsistency</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-design">API Design<a class="hash-link" aria-label="API Design的直接链接" title="API Design的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#api-design">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="design-principleto-deal-with-new-fields-for-dapr-api">Design Principle：To deal with new fields for Dapr API<a class="hash-link" aria-label="Design Principle：To deal with new fields for Dapr API的直接链接" title="Design Principle ：To deal with new fields for Dapr API的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#design-principleto-deal-with-new-fields-for-dapr-api">​</a></h3>
<p>We want to revert to the Dapr API, but there is certainly a need for customization in the long term.When our API and dapr are different (e.g. just want to give a new API field to Dapr), whether to open a new method name, or to add a field to the old method?
to add a field to the original method, this may cause a field conflict.</p>
<p>Some of the following ideas：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-method-name-as-long-as-the-api-changes-different-from-dapr">New method name as long as the API changes different from Dapr<a class="hash-link" aria-label="New method name as long as the API changes different from Dapr的直接链接" title="New method name as long as the API changes different from Dapr的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#new-method-name-as-long-as-the-api-changes-different-from-dapr">​</a></h4>
<p><img decoding="async" loading="lazy" alt="img_3.png" src="/en-US/assets/images/img_3-d00fc35d33a78d0465669a867032f3dd.png" width="284" height="284" class="img_ev3q"></p>
<p>New and old methods are supported when new methods are opened.<strong>For example, version v1 is Dapr API and version v2 is extended</strong></p>
<p>： Disadvantages</p>
<ol>
<li>To support two APIs</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-fields-also-use-old-method-names-but-jumps-in-numbers-leave-white">New fields also use old method names, but jumps in numbers, leave white<a class="hash-link" aria-label="New fields also use old method names, but jumps in numbers, leave white的直接链接" title="New fields also use old method names, but jumps in numbers, leave white的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#new-fields-also-use-old-method-names-but-jumps-in-numbers-leave-white">​</a></h4>
<p>： Disadvantages</p>
<ol>
<li>Make no more sense?If Dapr later added this field but the numbers are different, we would find it difficult to do so (e.g. we define it as 10, dapr then as 5, and we have one field that takes up both 5 and 10?)</li>
<li>If Dapr adds a similar but nuanced field, we find it difficult to add：to the field?</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="c-fields-are-directly-added-to-the-conflict-without-allowing-for-a-conflict-will-of-course-try-to-raise-issues-for-the-dapr-community">C. Fields are directly added to the conflict without allowing for a conflict (will, of course, try to raise issues for the Dapr community)<a class="hash-link" aria-label="C. Fields are directly added to the conflict without allowing for a conflict (will, of course, try to raise issues for the Dapr community)的直接链接" title="C. Fields are directly added to the conflict without allowing for a conflict (will, of course, try to raise issues for the Dapr community)的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#c-fields-are-directly-added-to-the-conflict-without-allowing-for-a-conflict-will-of-course-try-to-raise-issues-for-the-dapr-community">​</a></h4>
<p>In the future, when you really sit together to reach a consensus and make api-spec, you will start a new path to proto, and you will not worry about the current conflict.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" aria-label="Conclusion的直接链接" title="Conclusion的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#conclusion">​</a></h4>
<p>Discussion decides to follow C line</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="between-app-and-layotto">Between APP and Layotto<a class="hash-link" aria-label="Between APP and Layotto的直接链接" title="Between APP and Layotto的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#between-app-and-layotto">​</a></h3>
<p>Use the grpc API like Dapr</p>
<div class="language-protobuf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-protobuf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">service AppCallback {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Lists all topics subscribed by this app.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rpc ListTopicSubscriptions(google.protobuf.Empty) returns (ListTopicSubscriptionsResponse) {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Subscribes events from Pubsub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rpc OnTopicEvent(TopicEventRequest) returns (TopicEventResponse) {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-protobuf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-protobuf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Service Dapr LO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Publishes events to the specific topic.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rpc PublishEvent(PublishEventRequest) returns (google.protect.Empt) {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="between-layotto-and-component">Between Layotto and Component<a class="hash-link" aria-label="Between Layotto and Component的直接链接" title="Between Layotto and Component的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#between-layotto-and-component">​</a></h3>
<p>In the same way as Dapr;
PublishRequest.Data-and NewMessage.Data-fit for CloudEvent 1.0 (deserializable into map[string]interface</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// PubSub is the interface for message buses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> PubSub </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token function" style="color:#d73a49">Init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">metadata Metadata</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token function" style="color:#d73a49">Features</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token function" style="color:#d73a49">Publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">req </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">PublishRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token function" style="color:#d73a49">Subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">req SubscribeRequest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handler </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">NewMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// PublishRequest is the request to publish a message</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> PublishRequest </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Data       </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token plain">            </span><span class="token string" style="color:#e3116c">`json:&quot;data&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	PubsubName </span><span class="token builtin">string</span><span class="token plain">            </span><span class="token string" style="color:#e3116c">`json:&quot;pubsubname&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Topic      </span><span class="token builtin">string</span><span class="token plain">            </span><span class="token string" style="color:#e3116c">`json:&quot;topic&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Metadata   </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;metadata&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// NewMessage is an event arriving from a message bus instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> NewMessage </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Data     </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token plain">            </span><span class="token string" style="color:#e3116c">`json:&quot;data&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Topic    </span><span class="token builtin">string</span><span class="token plain">            </span><span class="token string" style="color:#e3116c">`json:&quot;topic&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Metadata </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;metadata&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sidecar-knows-which-port-of-the-callback">sidecar knows which port of the callback<a class="hash-link" aria-label="sidecar knows which port of the callback的直接链接" title="sidecar knows which port of the callback的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#sidecar-knows-which-port-of-the-callback">​</a></h3>
<p>Reference Dapr, configure callback port on startup.The cost is that sidecar can only serve one process.</p>
<p>Select this option for the current period</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-maintain-the-antecedents-of-the-subscription-list">How to maintain the antecedents of the subscription list<a class="hash-link" aria-label="How to maintain the antecedents of the subscription list的直接链接" title="How to maintain the antecedents of the subscription list的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#how-to-maintain-the-antecedents-of-the-subscription-list">​</a></h3>
<p>Ask an app on sidecar startup to get subscription at once.There is therefore a requirement for the order of start and start the app first.</p>
<p>Follow up the app to optimize it into scheduled poll app</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="subscription-support-declaration-configuration">Subscription support declaration configuration<a class="hash-link" aria-label="Subscription support declaration configuration的直接链接" title="Subscription support declaration configuration的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#subscription-support-declaration-configuration">​</a></h3>
<p>First issue only supports the format of the interface callback and then optimized with the declaration configuration</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="config-design">Config Design<a class="hash-link" aria-label="Config Design的直接链接" title="Config Design的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#config-design">​</a></h2>
<p><img decoding="async" loading="lazy" alt="img.png" src="/en-US/assets/images/config-1c1073af2d426d37bb76fb02f02baf3b.png" width="536" height="420" class="img_ev3q"></p>
<p>The relevant configuration of the app is in the loaded, and the code you want to reconfigure the configuration API, etc. (see below).</p>
<p><strong>Q: How to pass configuration data to Dapr and Layotto components</strong></p>
<p>A: pass metadata&#x27;s data through the Init interface to components</p>
<h1>Future Work</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-bigger-control-plane">A Bigger Control Plane<a class="hash-link" aria-label="A Bigger Control Plane的直接链接" title="A Bigger Control Plane的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#a-bigger-control-plane">​</a></h2>
<p>The Control Plane of Service Mesh serves only RPC, but in Runtime API the configuration of components also needs to be distributed in clusters; components also need to be discovered, routed, and so also have their own control Plane.</p>
<p>It would be better to have a Bigger Control Plane, which integrates RPC&#x27;s and all middleware configuration data.</p>
<p>may require extension of the ODS protocol, such as runtime Discovery Service</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="subscription-support-configuration">Subscription Support Configuration<a class="hash-link" aria-label="Subscription Support Configuration的直接链接" title="Subscription Support Configuration的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#subscription-support-configuration">​</a></h2>
<p>Subscription is now obtained by callback app, which can be added to get subscription by configuration</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="appcallback-supports-tls">appcallback supports tls<a class="hash-link" aria-label="appcallback supports tls的直接链接" title="appcallback supports tls的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#appcallback-supports-tls">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="detach-component-configuration-and-personality-configuration-callback-port-app-id">Detach component configuration and personality configuration (callback port, app-id)<a class="hash-link" aria-label="Detach component configuration and personality configuration (callback port, app-id)的直接链接" title="Detach component configuration and personality configuration (callback port, app-id)的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#detach-component-configuration-and-personality-configuration-callback-port-app-id">​</a></h2>
<p>Component configuration and app profile (callback port,app-id) are placed together with the following question：</p>
<ol>
<li>Not good at making cluster configuration leader</li>
<li>Component control configuration is not available (e.g. Dapr can limit app-id1 access only to topic_id1)</li>
</ol>
<p><img decoding="async" loading="lazy" alt="img_4.png" src="/en-US/assets/images/img_4-fcdf3a81a579645dfdfa89d7699b4a3e.png" width="827" height="624" class="img_ev3q"></p>
<p>Need to reconstruct the original component logic</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tracing">Tracing<a class="hash-link" aria-label="Tracing的直接链接" title="Tracing的直接链接" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#tracing">​</a></h2></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/mosn/layotto/edit/main/design/pubsub/pubsub-api-and-compability-with-dapr-component.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/en-US/docs/design/configuration/configuration-api-with-apollo"><div class="pagination-nav__sublabel">pre page</div><div class="pagination-nav__label">Implementing Configuration API with ctripcorp/apollo</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en-US/docs/design/rpc/rpc_design_document"><div class="pagination-nav__sublabel">next page</div><div class="pagination-nav__label">RPC Design Document</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#whether-the-corporate-architecturereuses-daprs-sdk-and-proto">Whether the corporate architecture：reuses Dapr&#39;s sdk and proto</a><ul><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#problems-encountered">Problems encountered</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#programmes">Programmes</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#api-design">API Design</a><ul><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#design-principleto-deal-with-new-fields-for-dapr-api">Design Principle：To deal with new fields for Dapr API</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#between-app-and-layotto">Between APP and Layotto</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#between-layotto-and-component">Between Layotto and Component</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#sidecar-knows-which-port-of-the-callback">sidecar knows which port of the callback</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#how-to-maintain-the-antecedents-of-the-subscription-list">How to maintain the antecedents of the subscription list</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#subscription-support-declaration-configuration">Subscription support declaration configuration</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#config-design">Config Design</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#a-bigger-control-plane">A Bigger Control Plane</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#subscription-support-configuration">Subscription Support Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#appcallback-supports-tls">appcallback supports tls</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#detach-component-configuration-and-personality-configuration-callback-port-app-id">Detach component configuration and personality configuration (callback port, app-id)</a></li><li><a class="table-of-contents__link toc-highlight" href="/en-US/docs/design/pubsub/pubsub-api-and-compability-with-dapr-component#tracing">Tracing</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>