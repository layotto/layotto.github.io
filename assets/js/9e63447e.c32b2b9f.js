"use strict";(self.webpackChunklayotto_docusaurus=self.webpackChunklayotto_docusaurus||[]).push([[3252],{756:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var t=s(4848),i=s(8453);const r={},a="File API \u8bbe\u8ba1\u6587\u6863",l={id:"design/file/file-design",title:"File API \u8bbe\u8ba1\u6587\u6863",description:"API",source:"@site/docs/design/file/file-design.md",sourceDirName:"design/file",slug:"/design/file/file-design",permalink:"/layotto/docs/design/file/file-design",draft:!1,unlisted:!1,editUrl:"https://github.com/mosn/layotto/edit/main/design/file/file-design.md",tags:[],version:"current",frontMatter:{},sidebar:"mySidebar",previous:{title:"Sequencer API\u8bbe\u8ba1\u6587\u6863",permalink:"/layotto/docs/design/sequencer/design"},next:{title:"FaaS\u8bbe\u8ba1\u6587\u6863",permalink:"/layotto/docs/design/faas/faas-poc-design"}},o={},d=[{value:"API",id:"api",level:2},{value:"\u53c2\u6570\u5b9a\u4e49",id:"\u53c2\u6570\u5b9a\u4e49",level:2},{value:"Get\u63a5\u53e3",id:"get\u63a5\u53e3",level:3},{value:"Put\u63a5\u53e3",id:"put\u63a5\u53e3",level:3},{value:"List\u548cDel\u63a5\u53e3",id:"list\u548cdel\u63a5\u53e3",level:3},{value:"\u914d\u7f6e\u53c2\u6570",id:"\u914d\u7f6e\u53c2\u6570",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"file-api-\u8bbe\u8ba1\u6587\u6863",children:"File API \u8bbe\u8ba1\u6587\u6863"}),"\n",(0,t.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,t.jsx)(n.p,{children:"API\u5b9a\u4e49\u4e3b\u8981\u4f9d\u636e\u5e38\u7528\u7684\u6587\u4ef6\u64cd\u4f5c\u6765\u5b9a\u4e49\u7684\uff0c\u5206\u4e3a\u589e\u5220\u6539\u67e5\u56db\u4e2a\u63a5\u53e3\uff0c\u5bf9\u4e8eGet/Put\u63a5\u53e3\u6765\u8bf4\uff0c\u6587\u4ef6\u7684\u4e0a\u4f20\u548c\u4e0b\u8f7d\u9700\u8981\u652f\u6301\u6d41\u4f20\u8f93\u3002\u56e0\u6b64\u63a5\u53e3\u5b9a\u4e49\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-protobuf",children:"  // Get file with stream\n  rpc GetFile(GetFileRequest) returns (stream GetFileResponse) {}\n\n  // Put file with stream\n  rpc PutFile(stream PutFileRequest) returns (google.protobuf.Empty) {}\n\n  // List all files\n  rpc ListFile(ListFileRequest) returns (ListFileResp){}\n\n  // Delete specific file\n  rpc DelFile(DelFileRequest) returns (google.protobuf.Empty){}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5173\u4e8e\u63a5\u53e3\u7684\u5b9a\u4e49\u7684\u8ba8\u8bba\u53ef\u4ee5\u53c2\u7167",(0,t.jsx)(n.a,{href:"https://github.com/mosn/layotto/issues/98",children:"issue98"})]}),"\n",(0,t.jsx)(n.h2,{id:"\u53c2\u6570\u5b9a\u4e49",children:"\u53c2\u6570\u5b9a\u4e49"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-protobuf",children:"message GetFileRequest {\n  //\n  string store_name = 1;\n  // The name of the file or object want to get.\n  string name = 2;\n  // The metadata for user extension.\n  map<string,string> metadata = 3;\n}\n\nmessage GetFileResponse {\n  bytes data = 1;\n}\n\nmessage PutFileRequest {\n  string store_name = 1;\n  // The name of the file or object want to put.\n  string name = 2;\n  // The data will be store.\n  bytes data = 3;\n  // The metadata for user extension.\n  map<string,string> metadata = 4;\n}\n\nmessage FileRequest {\n  string store_name = 1;\n  // The name of the directory\n  string name = 2;\n  // The metadata for user extension.\n  map<string,string> metadata = 3;\n}\n\nmessage ListFileRequest {\n  FileRequest request = 1;\n}\n\nmessage ListFileResp {\n  repeated string file_name = 1;\n}\n\nmessage DelFileRequest {\n  FileRequest request = 1;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"get\u63a5\u53e3",children:"Get\u63a5\u53e3"}),"\n",(0,t.jsx)(n.p,{children:"Get\u7684\u5165\u53c2\u4e3b\u8981\u6709\u4e09\u4e2a\uff1a"}),"\n",(0,t.jsxs)(n.p,{children:["| ",(0,t.jsx)(n.strong,{children:"\u53c2\u6570\u540d"})," | ",(0,t.jsx)(n.strong,{children:"\u610f\u4e49"})," | ",(0,t.jsx)(n.strong,{children:"\u662f\u5426\u5fc5\u4f20"})," |\n| --- | --- | --- | --- | --- | --- | --- |\n| store_name | \u540e\u7aef\u5bf9\u5e94\u7684components\uff08eg: aliyun.oss, aws.s3\uff09 | yes |\n| name | \u6587\u4ef6\u540d\u5b57 | yes|\n| metadata | \u5143\u6570\u636e\uff0c\u8be5\u5b57\u6bb5\u7528\u6237\u53ef\u4ee5\u7528\u6765\u6307\u5b9acomponent\u9700\u8981\u7684\u4e00\u4e9b\u5b57\u6bb5\uff0c\uff08eg:\u6743\u9650\uff0c\u7528\u6237\u540d\u7b49\uff09 | yes|"]}),"\n",(0,t.jsx)(n.h3,{id:"put\u63a5\u53e3",children:"Put\u63a5\u53e3"}),"\n",(0,t.jsx)(n.p,{children:"Put\u63a5\u53e3\u5165\u53c2\u4e3b\u8981\u6709\u4e09\u4e2a\uff0c\u591a\u4e86\u4e00\u4e2adata\u5b57\u6bb5\u7528\u6765\u4f20\u8f93\u6587\u4ef6\u5185\u5bb9\uff1a"}),"\n",(0,t.jsxs)(n.p,{children:["| ",(0,t.jsx)(n.strong,{children:"\u53c2\u6570\u540d"})," | ",(0,t.jsx)(n.strong,{children:"\u610f\u4e49"})," | ",(0,t.jsx)(n.strong,{children:"\u662f\u5426\u5fc5\u4f20"})," |\n| --- | --- | --- | --- | --- | --- | --- |\n| store_name | \u540e\u7aef\u5bf9\u5e94\u7684components\uff08eg: aliyun.oss, aws.s3\uff09 | yes |\n| name | \u6587\u4ef6\u540d\u5b57 | yes|\n| data | \u6587\u4ef6\u5185\u5bb9 | no\uff08\u5141\u8bb8\u7528\u6237\u4e0a\u4f20\u7a7a\u6570\u636e\uff0c\u6bcf\u4e2acomponent\u53ef\u4ee5\u505a\u5177\u4f53\u5b9e\u73b0\uff09|\n| metadata | \u5143\u6570\u636e\uff0c\u8be5\u5b57\u6bb5\u7528\u6237\u53ef\u4ee5\u7528\u6765\u6307\u5b9acomponent\u9700\u8981\u7684\u4e00\u4e9b\u5b57\u6bb5\uff0c\uff08eg:\u6743\u9650\uff0c\u7528\u6237\u540d\u7b49\uff09 | yes|"]}),"\n",(0,t.jsx)(n.h3,{id:"list\u548cdel\u63a5\u53e3",children:"List\u548cDel\u63a5\u53e3"}),"\n",(0,t.jsx)(n.p,{children:"\u4e24\u4e2a\u63a5\u53e3\u7684\u53c2\u6570\u662f\u4e00\u6837\u7684\uff1a"}),"\n",(0,t.jsxs)(n.p,{children:["| ",(0,t.jsx)(n.strong,{children:"\u53c2\u6570\u540d"})," | ",(0,t.jsx)(n.strong,{children:"\u610f\u4e49"})," | ",(0,t.jsx)(n.strong,{children:"\u662f\u5426\u5fc5\u4f20"})," |\n| --- | --- | --- | --- | --- | --- | --- |\n| store_name | \u540e\u7aef\u5bf9\u5e94\u7684components\uff08eg: aliyun.oss, aws.s3\uff09 | yes |\n| name | \u6587\u4ef6\u540d\u5b57 | yes|\n| metadata | \u5143\u6570\u636e\uff0c\u8be5\u5b57\u6bb5\u7528\u6237\u53ef\u4ee5\u7528\u6765\u6307\u5b9acomponent\u9700\u8981\u7684\u4e00\u4e9b\u5b57\u6bb5\uff0c\uff08eg:\u6743\u9650\uff0c\u7528\u6237\u540d\u7b49\uff09 | yes|"]}),"\n",(0,t.jsx)(n.h3,{id:"\u914d\u7f6e\u53c2\u6570",children:"\u914d\u7f6e\u53c2\u6570"}),"\n",(0,t.jsx)(n.p,{children:"\u914d\u7f6e\u53c2\u6570\uff0c\u4e0d\u540c\u7684component\u53ef\u4ee5\u914d\u7f6e\u4e0d\u540c\u683c\u5f0f\uff0c\u6bd4\u5982aliyun.oss\u7684\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-protobuf",children:'\n{\n    "file": {\n      "file_demo": {\n        "type": "aliyun.oss",\n        "metadata":[\n          {\n            "endpoint": "endpoint_address",\n            "accessKeyID": "accessKey",\n            "accessKeySecret": "secret",\n            "bucket": ["bucket1", "bucket2"]\n          }\n        ]\n      }\n    }\n}\n\n'})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var t=s(6540);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);