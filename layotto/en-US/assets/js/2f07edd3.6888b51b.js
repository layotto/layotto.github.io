"use strict";(self.webpackChunklayotto_docusaurus=self.webpackChunklayotto_docusaurus||[]).push([[8320],{9508:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var s=t(4848),r=t(8453);const o={},c="Reference secrets in component configuration",i={id:"start/secret/secret_ref",title:"Reference secrets in component configuration",description:"we can inject secrets to other components using secret store.",source:"@site/i18n/en-US/docusaurus-plugin-content-docs/current/start/secret/secret_ref.md",sourceDirName:"start/secret",slug:"/start/secret/secret_ref",permalink:"/layotto/en-US/docs/start/secret/secret_ref",draft:!1,unlisted:!1,editUrl:"https://github.com/mosn/layotto/edit/main/start/secret/secret_ref.md",tags:[],version:"current",frontMatter:{}},a={},d=[{value:"Quick start",id:"quick-start",level:2},{value:"Step 0:  Run Redis with password",id:"step-0--run-redis-with-password",level:3},{value:"Step 1:  Run Layotto",id:"step-1--run-layotto",level:3},{value:"Step 2: Run the client program and call Layotto to get the sequence",id:"step-2-run-the-client-program-and-call-layotto-to-get-the-sequence",level:3}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"reference-secrets-in-component-configuration",children:"Reference secrets in component configuration"}),"\n",(0,s.jsx)(n.p,{children:"we can inject secrets to other components using secret store."}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"secret_ref"})," in your config:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "sequencer": {\n    "redis": {\n      "type": "redis",\n      "metadata": {\n        "redisHost": "127.0.0.1:6380",\n      },\n      "secret_ref": [\n        {\n          "store_name": "local.file",\n          "key": "db-user-pass:password",\n          "sub_key": "db-user-pass:password",\n          "inject_as": "redisPassword"\n        }\n        ]\n    }\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["An example is ",(0,s.jsx)(n.a,{href:"https://github.com/mosn/layotto/blob/main/configs/config_ref_example.json",children:"config_ref_example.json"})]}),"\n",(0,s.jsx)(n.h2,{id:"quick-start",children:"Quick start"}),"\n",(0,s.jsx)(n.p,{children:"This example shows how to inject redis password to sequencer component using redis store"}),"\n",(0,s.jsx)(n.h3,{id:"step-0--run-redis-with-password",children:"Step 0:  Run Redis with password"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'docker run --name redis -p 6380:6379 -d --restart=always redis:5.0.3 redis-server --appendonly yes --requirepass "redis123"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"step-1--run-layotto",children:"Step 1:  Run Layotto"}),"\n",(0,s.jsx)(n.p,{children:"After downloading the project code to the local, switch the code directory and compile:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"cd ${project_path}/cmd/layotto\n"})}),"\n",(0,s.jsx)(n.p,{children:"build:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:"@if.not.exist layotto",children:"go build -o layotto\n"})}),"\n",(0,s.jsx)(n.p,{children:"Once finished, the layotto file will be generated in the directory, run it:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:"@background",children:"./layotto start -c ../../configs/config_ref_example.json\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-run-the-client-program-and-call-layotto-to-get-the-sequence",children:"Step 2: Run the client program and call Layotto to get the sequence"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:" cd ${project_path}/demo/sequencer/common/\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:"@if.not.exist client",children:" go build -o client\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:' ./client -s "redis"\n'})}),"\n",(0,s.jsx)(n.p,{children:"If the following information is printed, the demo is successful:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"Try to get next id.Key:key666 \nNext id:next_id:1 \nNext id:next_id:2 \nNext id:next_id:3 \nNext id:next_id:4 \nNext id:next_id:5 \nNext id:next_id:6 \nNext id:next_id:7 \nNext id:next_id:8 \nNext id:next_id:9 \nNext id:next_id:10 \nDemo success!\n\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>i});var s=t(6540);const r={},o=s.createContext(r);function c(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);