"use strict";(self.webpackChunklayotto_docusaurus=self.webpackChunklayotto_docusaurus||[]).push([[3328],{4855:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>l});var n=a(4848),o=a(8453);const r={},s="Actuator Http API",i={id:"building_blocks/actuator/actuator",title:"Actuator Http API",description:"Layotto Actuator API provides functions such as health check, view runtime metadata.It can be used to view the health status and runtime metadata of Layotto and app, and supports integration into open source infrastructure (for example, it can be integrated into k8s health check)",source:"@site/i18n/en-US/docusaurus-plugin-content-docs/current/building_blocks/actuator/actuator.md",sourceDirName:"building_blocks/actuator",slug:"/building_blocks/actuator/",permalink:"/layotto/en-US/docs/building_blocks/actuator/",draft:!1,unlisted:!1,editUrl:"https://github.com/mosn/layotto/edit/main/building_blocks/actuator/actuator.md",tags:[],version:"current",frontMatter:{},sidebar:"mySidebar",previous:{title:"File API",permalink:"/layotto/en-US/docs/building_blocks/file/"},next:{title:"State API",permalink:"/layotto/en-US/docs/building_blocks/state/reference"}},c={},l=[{value:"0. When to use Actuator Http API",id:"0-when-to-use-actuator-http-api",level:2},{value:"1. Health Check API",id:"1-health-check-api",level:2},{value:"/actuator/health/liveness",id:"actuatorhealthliveness",level:3},{value:"/actuator/health/readiness",id:"actuatorhealthreadiness",level:3},{value:"2. Query runtime metadata API",id:"2-query-runtime-metadata-api",level:2},{value:"/actuator/info",id:"actuatorinfo",level:3},{value:"3. Explanation for API path",id:"3-explanation-for-api-path",level:2},{value:"4. API usage example",id:"4-api-usage-example",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"actuator-http-api",children:"Actuator Http API"}),"\n",(0,n.jsx)(t.p,{children:"Layotto Actuator API provides functions such as health check, view runtime metadata.It can be used to view the health status and runtime metadata of Layotto and app, and supports integration into open source infrastructure (for example, it can be integrated into k8s health check)"}),"\n",(0,n.jsx)(t.p,{children:"Similar to Spring Boot Actuator, Actuator API has more imagination in the future: Monitoring, Metrics, Auditing, and more."}),"\n",(0,n.jsx)(t.h2,{id:"0-when-to-use-actuator-http-api",children:"0. When to use Actuator Http API"}),"\n",(0,n.jsx)(t.p,{children:"Actuator API is generally used for operation and maintenance systems. For example, k8s calls Actuator API to monitor the health status of Layotto and App. If the status is not good, k8s will restart the Pod or temporarily cut off the traffic;"}),"\n",(0,n.jsx)(t.p,{children:"For another example, on the Dashboard for SRE, by calling Actuator API, you can clearly see the metadata of each Layotto instance and App (for example, what is the current effective configuration), which is convenient for troubleshooting."}),"\n",(0,n.jsx)(t.h2,{id:"1-health-check-api",children:"1. Health Check API"}),"\n",(0,n.jsx)(t.h3,{id:"actuatorhealthliveness",children:"/actuator/health/liveness"}),"\n",(0,n.jsx)(t.p,{children:'Used to check the health status of Layotto and app. The health status can be used to determine "whether restarting is needed".'}),"\n",(0,n.jsx)(t.p,{children:"GET,no parameters."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'// http://localhost:8080/actuator/health/liveness\n// HTTP/1.1 200 OK\n\n{\n  "status": "UP",\n  "components": {\n    "livenessProbe": {\n      "status": "UP",\n      "details":{\n\t\t\t\t \n      }\n    }\n  }\n}\n'})}),"\n",(0,n.jsx)(t.p,{children:"Return field description:"}),"\n",(0,n.jsx)(t.p,{children:"HTTP status code 200 means success, other (status code above 400) means failure."}),"\n",(0,n.jsx)(t.p,{children:"There are three types of status fields:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-go",children:'var (\n\t// INIT means it is starting\n\tINIT = Status("INIT")\n\t// UP means it is healthy\n\tUP   = Status("UP")\n\t// DOWN means it is unhealthy\n\tDOWN = Status("DOWN")\n)\n'})}),"\n",(0,n.jsxs)(t.p,{children:["Note: By default, the API will only return the health status of Layotto. If you want the API to also return the health status of the App, you need to develop a plugin that calls back the App. You can refer to ",(0,n.jsx)(t.a,{href:"/layotto/en-US/docs/design/actuator/actuator-design-doc",children:"Actuator's design document"}),", or contact us directly to provide you with a detailed explanation."]}),"\n",(0,n.jsx)(t.h3,{id:"actuatorhealthreadiness",children:"/actuator/health/readiness"}),"\n",(0,n.jsx)(t.p,{children:'Used to check the health status of Layotto and app. The health status can be used to determine "Do we need to temporarily cut off the traffic and make sure no user visit this machine"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Q: What is the difference with the above API?"})}),"\n",(0,n.jsx)(t.p,{children:'A: The liveness check is used to check some unrecoverable faults, "Do we need to restart it";\nReadiness is used to check some temporary and recoverable states. For example, the application is warming up the cache. It needs to tell the infrastructure "Don\'t lead traffic to me now". After it finishes warming up, the infrastructure will reinvoke the API and get the result "I am ready to serve customers"'}),"\n",(0,n.jsx)(t.p,{children:"GET,no parameters."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'// http://localhost:8080/actuator/health/readiness\n// HTTP/1.1 503 SERVICE UNAVAILABLE\n\n{\n  "status": "DOWN",\n  "components": {\n    "readinessProbe": {\n      "status": "DOWN"\n    }\n  }\n}\n'})}),"\n",(0,n.jsxs)(t.p,{children:["Note: By default, the API will only return the health status of Layotto. If you want the API to also return the health status of the App, you need to develop a plugin that calls back the App. You can refer to ",(0,n.jsx)(t.a,{href:"/layotto/en-US/docs/design/actuator/actuator-design-doc",children:"Actuator's design document"}),", or contact us directly to provide you with a detailed explanation."]}),"\n",(0,n.jsx)(t.h2,{id:"2-query-runtime-metadata-api",children:"2. Query runtime metadata API"}),"\n",(0,n.jsx)(t.h3,{id:"actuatorinfo",children:"/actuator/info"}),"\n",(0,n.jsx)(t.p,{children:"Used to view the runtime metadata of Layotto and app."}),"\n",(0,n.jsx)(t.p,{children:"GET,no parameters."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'// http://localhost:8080/actuator/health/liveness\n// HTTP/1.1 200 OK\n\n{\n    "app" : {\n        "version" : "1.0.0",\n        "name" : "Layotto"\n    }\n}\n'})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Q: Which runtime metadata will be returned?"})}),"\n",(0,n.jsx)(t.p,{children:"Currently only version number"}),"\n",(0,n.jsx)(t.p,{children:"We can add more information in the future:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Callback app"}),"\n",(0,n.jsx)(t.li,{children:"Runtime configuration parameters"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Actuator adopts a plug-in architecture, you can also add your own plug-ins as needed, and let the API return the runtime metadata you care about."}),"\n",(0,n.jsxs)(t.p,{children:["Note: By default, the API will only return Layotto's runtime metadata. If you want the API to also return the App's runtime metadata, you need to develop a plugin that calls back the App. You can refer to ",(0,n.jsx)(t.a,{href:"/layotto/en-US/docs/design/actuator/actuator-design-doc",children:"Actuator's design document"}),", or contact us directly to provide you with a detailed explanation."]}),"\n",(0,n.jsx)(t.h2,{id:"3-explanation-for-api-path",children:"3. Explanation for API path"}),"\n",(0,n.jsx)(t.p,{children:"Actuator API path adopts restful style. After different Endpoints are registered in Actuator, the path is:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"/actuator/{endpoint_name}/{params}\n"})}),"\n",(0,n.jsx)(t.p,{children:"For example:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"/actuator/health/liveness\n"})}),"\n",(0,n.jsx)(t.p,{children:"The 'health' element in the path above identifies the Endpoint name is health, and 'liveness' is the parameter passed to the health Endpoint."}),"\n",(0,n.jsx)(t.p,{children:"Multiple parameters can be passed, such as /actuator/xxxendpoint/a/b/c/d, and the semantics of the parameters are determined by each Endpoint."}),"\n",(0,n.jsx)(t.p,{children:"The paths registered by default are:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"/actuator/health/liveness\n\n/actuator/health/readiness\n\n/actuator/info\n"})}),"\n",(0,n.jsx)(t.h2,{id:"4-api-usage-example",children:"4. API usage example"}),"\n",(0,n.jsxs)(t.p,{children:["See ",(0,n.jsx)(t.a,{href:"/layotto/en-US/docs/start/actuator/start",children:"Quick start document"})]})]})}function d(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},8453:(e,t,a)=>{a.d(t,{R:()=>s,x:()=>i});var n=a(6540);const o={},r=n.createContext(o);function s(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);