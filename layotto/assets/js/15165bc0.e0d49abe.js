"use strict";(self.webpackChunklayotto_docusaurus=self.webpackChunklayotto_docusaurus||[]).push([[6436],{7721:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>x,frontMatter:()=>c,metadata:()=>d,toc:()=>a});var t=s(4848),r=s(8453);const c={},o="\u4f7f\u7528 Secret Ref \u6ce8\u5165secret",d={id:"start/secret/secret_ref",title:"\u4f7f\u7528 Secret Ref \u6ce8\u5165secret",description:"\u6211\u4eec\u53ef\u4ee5\u7528secret store\u5c06secrets\u6ce8\u5165\u5230\u5176\u4ed6\u7ec4\u4ef6\u3002",source:"@site/docs/start/secret/secret_ref.md",sourceDirName:"start/secret",slug:"/start/secret/secret_ref",permalink:"/layotto/docs/start/secret/secret_ref",draft:!1,unlisted:!1,editUrl:"https://github.com/mosn/layotto/edit/main/start/secret/secret_ref.md",tags:[],version:"current",frontMatter:{}},i={},a=[{value:"\u5feb\u901f\u5f00\u59cb",id:"\u5feb\u901f\u5f00\u59cb",level:2},{value:"Step 0:  \u8fd0\u884credis\u5e76\u521d\u8bd5\u5bc6\u7801",id:"step-0--\u8fd0\u884credis\u5e76\u521d\u8bd5\u5bc6\u7801",level:3},{value:"Step 1:  \u8fd0\u884c Layotto",id:"step-1--\u8fd0\u884c-layotto",level:3},{value:"\u7b2c\u4e8c\u6b65\uff1a\u8fd0\u884c\u5ba2\u6237\u7aef\u7a0b\u5e8f\uff0c\u8c03\u7528 Layotto \u83b7\u53d6sequence",id:"\u7b2c\u4e8c\u6b65\u8fd0\u884c\u5ba2\u6237\u7aef\u7a0b\u5e8f\u8c03\u7528-layotto-\u83b7\u53d6sequence",level:3}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"\u4f7f\u7528-secret-ref-\u6ce8\u5165secret",children:"\u4f7f\u7528 Secret Ref \u6ce8\u5165secret"}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u4eec\u53ef\u4ee5\u7528secret store\u5c06secrets\u6ce8\u5165\u5230\u5176\u4ed6\u7ec4\u4ef6\u3002"}),"\n",(0,t.jsxs)(n.p,{children:["\u7528 ",(0,t.jsx)(n.code,{children:"secret_ref"})," \u6765\u914d\u7f6e:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "sequencer": {\n    "redis": {\n      "type": "redis",\n      "metadata": {\n        "redisHost": "127.0.0.1:6380",\n        "redisPassword": ""\n      },\n      "secret_ref": [\n        {\n          "store_name": "local.file",\n          "key": "db-user-pass:password",\n          "sub_key": "db-user-pass:password",\n          "inject_as": "redisPassword"\n        }\n      ]\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u4e00\u4e2a\u793a\u4f8b\u662f ",(0,t.jsx)(n.a,{href:"https://github.com/mosn/layotto/blob/main/configs/config_ref_example.json",children:"config_ref_example.json"})]}),"\n",(0,t.jsx)(n.h2,{id:"\u5feb\u901f\u5f00\u59cb",children:"\u5feb\u901f\u5f00\u59cb"}),"\n",(0,t.jsx)(n.p,{children:"\u8be5\u793a\u4f8b\u5c55\u793a\u4e86\u5982\u4f55\u6ce8\u5165redis password\u5230sequencer\u7ec4\u4ef6"}),"\n",(0,t.jsx)(n.h3,{id:"step-0--\u8fd0\u884credis\u5e76\u521d\u8bd5\u5bc6\u7801",children:"Step 0:  \u8fd0\u884credis\u5e76\u521d\u8bd5\u5bc6\u7801"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'docker run --name redis -p 6380:6379 -d --restart=always redis:5.0.3 redis-server --appendonly yes --requirepass "redis123"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"step-1--\u8fd0\u884c-layotto",children:"Step 1:  \u8fd0\u884c Layotto"}),"\n",(0,t.jsx)(n.p,{children:"\u5c06\u9879\u76ee\u4ee3\u7801\u4e0b\u8f7d\u5230\u672c\u5730\u540e\uff0c\u5207\u6362\u4ee3\u7801\u76ee\u5f55\u3001\u7f16\u8bd1\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"cd ${project_path}/cmd/layotto\n"})}),"\n",(0,t.jsx)(n.p,{children:"build:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",metastring:"@if.not.exist layotto",children:"go build -o layotto\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5b8c\u6210\u540e\u76ee\u5f55\u4e0b\u4f1a\u751f\u6210layotto\u6587\u4ef6\uff0c\u8fd0\u884c\u5b83\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",metastring:"@background",children:"./layotto start -c ../../configs/config_ref_example.json\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u7b2c\u4e8c\u6b65\u8fd0\u884c\u5ba2\u6237\u7aef\u7a0b\u5e8f\u8c03\u7528-layotto-\u83b7\u53d6sequence",children:"\u7b2c\u4e8c\u6b65\uff1a\u8fd0\u884c\u5ba2\u6237\u7aef\u7a0b\u5e8f\uff0c\u8c03\u7528 Layotto \u83b7\u53d6sequence"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:" cd ${project_path}/demo/sequencer/common/\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",metastring:"@if.not.exist client",children:" go build -o client\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:' ./client -s "redis"\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u6253\u5370\u51fa\u5982\u4e0b\u4fe1\u606f\u5219\u4ee3\u8868\u8c03\u7528\u6210\u529f\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"Try to get next id.Key:key666 \nNext id:next_id:1 \nNext id:next_id:2 \nNext id:next_id:3 \nNext id:next_id:4 \nNext id:next_id:5 \nNext id:next_id:6 \nNext id:next_id:7 \nNext id:next_id:8 \nNext id:next_id:9 \nNext id:next_id:10 \nDemo success!\n\n"})})]})}function x(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var t=s(6540);const r={},c=t.createContext(r);function o(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);