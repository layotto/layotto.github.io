"use strict";(self.webpackChunklayotto_docusaurus=self.webpackChunklayotto_docusaurus||[]).push([[5725],{4271:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>a,toc:()=>i});var n=o(4848),s=o(8453);const c={},r="\u4f7f\u7528Configuration API\u8c03\u7528Etcd\u914d\u7f6e\u4e2d\u5fc3",a={id:"start/configuration/start",title:"\u4f7f\u7528Configuration API\u8c03\u7528Etcd\u914d\u7f6e\u4e2d\u5fc3",description:"\u672c\u793a\u4f8b\u5c55\u793a\u4e86\u4f7f\u7528 etcd \u4f5c\u4e3a\u914d\u7f6e\u4e2d\u5fc3\u65f6\uff0c\u5982\u4f55\u901a\u8fc7Layotto\uff0c\u5bf9 etcd \u914d\u7f6e\u4e2d\u5fc3\u8fdb\u884c\u589e\u5220\u6539\u67e5\u4ee5\u53ca watch\u3002",source:"@site/docs/start/configuration/start.md",sourceDirName:"start/configuration",slug:"/start/configuration/start",permalink:"/layotto/docs/start/configuration/start",draft:!1,unlisted:!1,editUrl:"https://github.com/mosn/layotto/edit/main/start/configuration/start.md",tags:[],version:"current",frontMatter:{},sidebar:"mySidebar",previous:{title:"\u4f7f\u7528Configuration API\u8c03\u7528apollo\u914d\u7f6e\u4e2d\u5fc3",permalink:"/layotto/docs/start/configuration/start-apollo"},next:{title:"\u4f7f\u7528Configuration API\u8c03\u7528nacos\u914d\u7f6e\u4e2d\u5fc3",permalink:"/layotto/docs/start/configuration/start-nacos"}},d={},i=[{value:"step 1. \u542f\u52a8 etcd \u548c Layotto",id:"step-1-\u542f\u52a8-etcd-\u548c-layotto",level:2},{value:"<strong>\u4f7f\u7528 Docker Compose</strong>",id:"\u4f7f\u7528-docker-compose",level:3},{value:"<strong>\u672c\u5730\u7f16\u8bd1\uff08\u4e0d\u9002\u5408 Windows)</strong>",id:"\u672c\u5730\u7f16\u8bd1\u4e0d\u9002\u5408-windows",level:3},{value:"step 1.1 \u542f\u52a8 etcd",id:"step-11-\u542f\u52a8-etcd",level:3},{value:"step 1.2 \u542f\u52a8 layotto",id:"step-12-\u542f\u52a8-layotto",level:3},{value:"step 2. \u542f\u52a8\u6d4b\u8bd5demo",id:"step-2-\u542f\u52a8\u6d4b\u8bd5demo",level:2},{value:"step 3.\u9500\u6bc1\u5bb9\u5668,\u91ca\u653e\u8d44\u6e90",id:"step-3\u9500\u6bc1\u5bb9\u5668\u91ca\u653e\u8d44\u6e90",level:2},{value:"<strong>\u5173\u95ed Docker Compose</strong>",id:"\u5173\u95ed-docker-compose",level:3},{value:"<strong>\u9500\u6bc1 etcd Docker \u5bb9\u5668</strong>",id:"\u9500\u6bc1-etcd-docker-\u5bb9\u5668",level:3},{value:"\u4e0b\u4e00\u6b65",id:"\u4e0b\u4e00\u6b65",level:2},{value:"\u8fd9\u4e2a\u5ba2\u6237\u7aefDemo\u505a\u4e86\u4ec0\u4e48\uff1f",id:"\u8fd9\u4e2a\u5ba2\u6237\u7aefdemo\u505a\u4e86\u4ec0\u4e48",level:3},{value:"\u7ec6\u8282\u4ee5\u540e\u518d\u8bf4\uff0c\u7ee7\u7eed\u4f53\u9a8c\u5176\u4ed6API",id:"\u7ec6\u8282\u4ee5\u540e\u518d\u8bf4\u7ee7\u7eed\u4f53\u9a8c\u5176\u4ed6api",level:3}];function l(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"\u4f7f\u7528configuration-api\u8c03\u7528etcd\u914d\u7f6e\u4e2d\u5fc3",children:"\u4f7f\u7528Configuration API\u8c03\u7528Etcd\u914d\u7f6e\u4e2d\u5fc3"}),"\n",(0,n.jsx)(t.p,{children:"\u672c\u793a\u4f8b\u5c55\u793a\u4e86\u4f7f\u7528 etcd \u4f5c\u4e3a\u914d\u7f6e\u4e2d\u5fc3\u65f6\uff0c\u5982\u4f55\u901a\u8fc7Layotto\uff0c\u5bf9 etcd \u914d\u7f6e\u4e2d\u5fc3\u8fdb\u884c\u589e\u5220\u6539\u67e5\u4ee5\u53ca watch\u3002"}),"\n",(0,n.jsx)(t.p,{children:"\u672c\u793a\u4f8b\u67b6\u6784\u5982\u4e0b\u56fe\uff0c\u542f\u52a8\u7684\u8fdb\u7a0b\u6709\uff1a\u5ba2\u6237\u7aef\u7a0b\u7a0b\u5e8f\u3001Layotto\u3001etcd \u3002"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://gw.alipayobjects.com/mdn/rms_5891a1/afts/img/A*dzGaSb78UCoAAAAAAAAAAAAAARQnAQ",alt:""})}),"\n",(0,n.jsx)(t.h2,{id:"step-1-\u542f\u52a8-etcd-\u548c-layotto",children:"step 1. \u542f\u52a8 etcd \u548c Layotto"}),"\n",(0,n.jsx)(t.h3,{id:"\u4f7f\u7528-docker-compose",children:(0,n.jsx)(t.strong,{children:"\u4f7f\u7528 Docker Compose"})}),"\n",(0,n.jsx)(t.p,{children:"\u60a8\u53ef\u4ee5\u4f7f\u7528 docker-compose \u542f\u52a8 etcd \u548c Layotto"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"cd docker/layotto-etcd\n# Start etcd and layotto with docker-compose\ndocker-compose up -d\n"})}),"\n",(0,n.jsx)(t.h3,{id:"\u672c\u5730\u7f16\u8bd1\u4e0d\u9002\u5408-windows",children:(0,n.jsx)(t.strong,{children:"\u672c\u5730\u7f16\u8bd1\uff08\u4e0d\u9002\u5408 Windows)"})}),"\n",(0,n.jsx)(t.p,{children:"\u60a8\u53ef\u4ee5\u4f7f\u7528 Docker \u8fd0\u884c etcd\uff0c\u7136\u540e\u672c\u5730\u7f16\u8bd1\u3001\u8fd0\u884c Layotto\u3002"}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsx)(t.p,{children:"[!TIP|label: \u4e0d\u9002\u5408 Windows \u7528\u6237]\nLayotto \u5728 Windows \u4e0b\u4f1a\u7f16\u8bd1\u5931\u8d25\u3002\u5efa\u8bae Windows \u7528\u6237\u4f7f\u7528 docker-compose \u90e8\u7f72"}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"step-11-\u542f\u52a8-etcd",children:"step 1.1 \u542f\u52a8 etcd"}),"\n",(0,n.jsxs)(t.p,{children:["etcd\u7684\u542f\u52a8\u65b9\u5f0f\u53ef\u4ee5\u53c2\u8003etcd\u7684",(0,n.jsx)(t.a,{href:"https://etcd.io/docs/v3.5/quickstart/",children:"\u5b98\u65b9\u6587\u6863"})]}),"\n",(0,n.jsx)(t.p,{children:"\u7b80\u5355\u8bf4\u660e\uff1a"}),"\n",(0,n.jsxs)(t.p,{children:["\u8bbf\u95ee ",(0,n.jsx)(t.a,{href:"https://github.com/etcd-io/etcd/releases",children:"https://github.com/etcd-io/etcd/releases"})," \u4e0b\u8f7d\u5bf9\u5e94\u64cd\u4f5c\u7cfb\u7edf\u7684 etcd\uff08\u4e5f\u53ef\u4ee5\u7528 docker\uff0c\u4f46\u662f\u4e0b\u8f7d\u5b98\u65b9\u7f16\u8bd1\u597d\u7684 etcd \u66f4\u7b80\u5355\uff09"]}),"\n",(0,n.jsx)(t.p,{children:"\u4f8b\u5982\uff0c\u5982\u679c\u662f macOS amd64 \u7528\u6237\uff0c\u53ef\u4ee5\u70b9\u51fb\u4e0b\u8f7d\uff1a"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://gw.alipayobjects.com/mdn/rms_5891a1/afts/img/A*sc_HQaMXg4YAAAAAAAAAAAAAARQnAQ",alt:""})}),"\n",(0,n.jsx)(t.p,{children:"\u4e0b\u8f7d\u5b8c\u6210\u6267\u884c\u547d\u4ee4\u542f\u52a8\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",metastring:"@background",children:"./etcd\n"})}),"\n",(0,n.jsxs)(t.p,{children:["\u9ed8\u8ba4\u76d1\u542c\u5730\u5740\u4e3a ",(0,n.jsx)(t.code,{children:"localhost:2379"})]}),"\n",(0,n.jsx)(t.h3,{id:"step-12-\u542f\u52a8-layotto",children:"step 1.2 \u542f\u52a8 layotto"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"cd ${project_path}/cmd/layotto\n"})}),"\n",(0,n.jsx)(t.p,{children:"\u6784\u5efa:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",metastring:"@if.not.exist layotto",children:"go build -o layotto\n"})}),"\n",(0,n.jsx)(t.p,{children:"\u7f16\u8bd1\u6210\u529f\u540e\u6267\u884c:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",metastring:"@background",children:"./layotto start -c ../../configs/runtime_config.json\n"})}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsxs)(t.p,{children:["\u89e3\u91ca\uff1a",(0,n.jsx)(t.a,{href:"https://github.com/mosn/layotto/blob/main/configs/runtime_config.json",children:"runtime_config.json"})," \u662f Layotto \u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5b83\u5728 ",(0,n.jsx)(t.code,{children:"config_store"})," \u4e2d\u58f0\u660e\u4e86\u4f7f\u7528 etcd \u4f5c\u4e3a\u914d\u7f6e\u4e2d\u5fc3\u3002\u7528\u6237\u53ef\u4ee5\u66f4\u6539\u914d\u7f6e\u6587\u4ef6\uff0c\u6539\u6210\u4f7f\u7528\u81ea\u5df1\u60f3\u8981\u7528\u7684\u5176\u4ed6\u914d\u7f6e\u4e2d\u5fc3\uff08\u76ee\u524d\u652f\u6301 etcd \u548c apollo\uff09\u3002"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"step-2-\u542f\u52a8\u6d4b\u8bd5demo",children:"step 2. \u542f\u52a8\u6d4b\u8bd5demo"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:" cd ${project_path}/demo/configuration/common\n"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",metastring:"@if.not.exist client",children:" go build -o client\n"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:' ./client -s "config_demo"\n'})}),"\n",(0,n.jsx)(t.p,{children:"\u6253\u5370\u51fa\u5982\u4e0b\u4fe1\u606f\u5219\u4ee3\u8868\u542f\u52a8\u5b8c\u6210\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'save key success\nget configuration after save, &{Key:key1 Content:value1 Group:application Label:prod Tags:map[feature:print release:1.0.0] Metadata:map[]} \nget configuration after save, &{Key:haha Content:heihei Group:application Label:prod Tags:map[feature:haha release:1.0.0] Metadata:map[]} \ndelete keys success\nwrite start\nreceive subscribe resp store_name:"config_demo" app_id:"apollo" items:<key:"heihei" content:"heihei1" group:"application" label:"prod" tags:<key:"feature" value:"haha" > tags:<key:"release" value:"16" > >\n'})}),"\n",(0,n.jsx)(t.h2,{id:"step-3\u9500\u6bc1\u5bb9\u5668\u91ca\u653e\u8d44\u6e90",children:"step 3.\u9500\u6bc1\u5bb9\u5668,\u91ca\u653e\u8d44\u6e90"}),"\n",(0,n.jsx)(t.h3,{id:"\u5173\u95ed-docker-compose",children:(0,n.jsx)(t.strong,{children:"\u5173\u95ed Docker Compose"})}),"\n",(0,n.jsx)(t.p,{children:"\u5982\u679c\u60a8\u662f\u7528 docker-compose \u542f\u52a8\u7684 etcd \u548c Layotto\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u5173\u95ed\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"cd ${project_path}/docker/layotto-etcd\ndocker-compose stop\n"})}),"\n",(0,n.jsx)(t.h3,{id:"\u9500\u6bc1-etcd-docker-\u5bb9\u5668",children:(0,n.jsx)(t.strong,{children:"\u9500\u6bc1 etcd Docker \u5bb9\u5668"})}),"\n",(0,n.jsx)(t.p,{children:"\u5982\u679c\u60a8\u662f\u7528 Docker \u542f\u52a8\u7684 etcd\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u9500\u6bc1 etcd \u5bb9\u5668\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"docker rm -f etcd\n"})}),"\n",(0,n.jsx)(t.h2,{id:"\u4e0b\u4e00\u6b65",children:"\u4e0b\u4e00\u6b65"}),"\n",(0,n.jsx)(t.h3,{id:"\u8fd9\u4e2a\u5ba2\u6237\u7aefdemo\u505a\u4e86\u4ec0\u4e48",children:"\u8fd9\u4e2a\u5ba2\u6237\u7aefDemo\u505a\u4e86\u4ec0\u4e48\uff1f"}),"\n",(0,n.jsx)(t.p,{children:"\u793a\u4f8b\u5ba2\u6237\u7aef\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u4e86Layotto\u63d0\u4f9b\u7684golang\u7248\u672csdk\uff0c\u8c03\u7528Layotto \u7684Configuration API\u5bf9\u914d\u7f6e\u6570\u636e\u8fdb\u884c\u589e\u5220\u6539\u67e5\u3001\u8ba2\u9605\u53d8\u66f4\u3002"}),"\n",(0,n.jsxs)(t.p,{children:["sdk\u4f4d\u4e8e",(0,n.jsx)(t.code,{children:"sdk"}),"\u76ee\u5f55\u4e0b\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7sdk\u8c03\u7528Layotto\u63d0\u4f9b\u7684API\u3002"]}),"\n",(0,n.jsx)(t.p,{children:"\u9664\u4e86\u4f7f\u7528sdk\uff0c\u60a8\u4e5f\u53ef\u4ee5\u7528\u4efb\u4f55\u60a8\u559c\u6b22\u7684\u8bed\u8a00\u3001\u901a\u8fc7grpc\u76f4\u63a5\u548cLayotto\u4ea4\u4e92\u3002"}),"\n",(0,n.jsx)(t.p,{children:"\u5176\u5b9esdk\u53ea\u662f\u5bf9grpc\u5f88\u8584\u7684\u5c01\u88c5\uff0c\u7528sdk\u7ea6\u7b49\u4e8e\u76f4\u63a5\u7528grpc\u8c03\u3002"}),"\n",(0,n.jsx)(t.h3,{id:"\u7ec6\u8282\u4ee5\u540e\u518d\u8bf4\u7ee7\u7eed\u4f53\u9a8c\u5176\u4ed6api",children:"\u7ec6\u8282\u4ee5\u540e\u518d\u8bf4\uff0c\u7ee7\u7eed\u4f53\u9a8c\u5176\u4ed6API"}),"\n",(0,n.jsx)(t.p,{children:"\u901a\u8fc7\u5de6\u4fa7\u7684\u5bfc\u822a\u680f\uff0c\u7ee7\u7eed\u4f53\u9a8c\u522b\u7684API\u5427\uff01"})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,t,o)=>{o.d(t,{R:()=>r,x:()=>a});var n=o(6540);const s={},c=n.createContext(s);function r(e){const t=n.useContext(c);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(c.Provider,{value:t},e.children)}}}]);